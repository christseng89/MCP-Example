# **BPMN Object Types

## Start Event Types

### 1. **Message Start Event（訊息啟動事件）**

📩 **範例**：

* 銀行接收到一份客戶的付款申請報文（SWIFT/ISO20022）。
* 電商系統收到顧客的下單請求。

➡️ 一旦收到訊息，流程立即啟動。

---

### 2. **Timer Start Event（定時器啟動事件）**

⏰ **範例**：

* 每天凌晨 2 點自動啟動「日終對帳」流程。
* 每週一上午 9 點自動啟動「銷售週報生成」流程。

➡️ 流程由時間條件觸發。

---

### 3. **Conditional Start Event（條件啟動事件）**

📄 **範例**：

* 當庫存數量低於 100 件時，自動啟動「補貨流程」。
* 當信用卡交易金額超過 10 萬元時，自動啟動「風控審批流程」。

➡️ 當資料或業務規則滿足條件時，流程自動開始。

---

### 4. **Signal Start Event（信號啟動事件）**

📡 **範例**：

* 當公司系統廣播一個「年度結算開始」信號後，各部門的對應流程（財務結算、人事考核、銷售清算）同時啟動。
* 當供應鏈平台發出「緊急供應中斷」信號後，自動觸發備援採購和風險控制流程。

➡️ 一個流程廣播訊號，其他流程只要訂閱該訊號就會被觸發。

---

📌 總結：

* **Message** → 由外部訊息觸發（客戶下單、API 請求）。
* **Timer** → 由時間觸發（定時任務）。
* **Conditional** → 由條件觸發（庫存不足、金額超標）。
* **Signal** → 由廣播事件觸發（全局通知，多個流程響應）。

---

## Task Types

### 1. **User Task（使用者任務 w IT）**

👤 **例子**：

* 銀行業務員審批一筆信用證申請。
* 客戶經由前端系統輸入付款資料。

➡️ **需要人工操作（通常透過系統介面完成）**。

---

### 2. **Service Task（服務任務）**

⚙️ **例子**：

* 系統自動調用 API 查詢黑名單資料庫。
* ERP 系統自動更新存貨狀態。

➡️ **系統自動執行，不需人工介入**。

---

### 3. **Send Task（發送任務）**

✉️ **例子**：

* 系統自動寄送「付款確認通知」Email 給客戶。
* 核心銀行系統發送 SWIFT 訊息到對手銀行。

➡️ **主動發送訊息給外部對象**。

---

### 4. **Receive Task（接收任務）**

📩 **例子**：

* 等待供應商回覆「發票文件」。
* 等待客戶上傳 KYC 文件。

➡️ **流程需等到訊息到達後才繼續**。

---

### 5. **Manual Task（手工任務 w/o IT）**

✋ **例子**：

* 倉庫人員實際清點貨物。
* 快遞員到客戶處收件。

➡️ **非系統輔助，純人工完成**。

---

### 6. **Business Rule Task（業務規則任務）**

📊 **例子**：

* 系統根據風險規則決定交易是否需要額外審批。
* 採購流程自動判斷：金額超過 100 萬 → 需要主管審批。

➡️ **透過規則引擎 (例如 *DMN*) 自動判斷**。

---

### 7. **Script Task（腳本任務）**

📜 **例子**：

* 系統執行一段 SQL 腳本產生報表。
* 用 Python 腳本進行資料清洗。

➡️ **嵌入簡單腳本由引擎執行**。

---

### 8. **Call Activity（呼叫活動）**

🔁 **例子**：

* 在「處理信用證」流程中，呼叫一個標準子流程「KYC 驗證流程」。
* 在「供應鏈採購」流程中，重用「付款流程」。

➡️ **重複利用子流程或外部流程**。

---

📌 總結：

* **User/Manual** → 有人工操作。
* **Service/Script/Business Rule** → 系統自動執行。
* **Send/Receive** → 與外部訊息交互。
* **Call Activity** → 重用既有子流程。

---

## **BPMN** 裡，**Call Activity** 和 **Subprocess** 用途與語義不同：

---

## 1. Subprocess（子流程）

* **定義**：子流程是嵌套在主流程裡的一部分，屬於 **該流程的一個組成單元**。
* **特徵**：

  * 在圖形上通常是 **圓角矩形 + 展開或折疊符號**。
  * 它 **屬於當前流程的一部分**，不能單獨重用。
* **適用場景**：

  * 在「處理訂單」主流程中，有一段邏輯比較複雜，例如「驗證付款」，可以拉出來做成一個 Subprocess，保持主流程乾淨。

---

## 2. Call Activity（呼叫活動）

* **定義**：Call Activity 會呼叫一個 **獨立定義的流程（或全局任務）**，類似程式中的「函數呼叫」。
* **特徵**：

  * 在圖形上是 **粗邊框的矩形**。
  * 它呼叫的是 **流程庫裡已經定義好的另一個流程**，可以在多個流程間重用。
* **適用場景**：

  * 銀行的所有業務流程（信用證、貸款、貿易融資）中，都可能要做 **KYC 驗證**。這時候把 KYC 驗證定義成一個獨立流程，透過 Call Activity 在不同主流程中呼叫。

---

## 3. 對比表

| 特性          | Subprocess（子流程）  | Call Activity（呼叫活動） |
| ----------- | ---------------- | ------------------- |
| **是否屬於主流程** | 是，嵌套在主流程內部       | 否，呼叫一個獨立定義的流程       |
| **可否重用**    | 不可重用（僅限於此流程）     | 可重用（不同流程都能呼叫同一個流程）  |
| **圖形表現**    | 圓角矩形（裡面可展開細節）    | 粗邊框矩形（呼叫外部流程）       |
| **使用場景**    | 主流程內邏輯複雜但只服務於此流程 | 標準流程或任務會被多個流程反覆呼叫   |

---

👉 簡單記法：

* **Subprocess = 內部封裝**（流程的一部分）。
* **Call Activity = 外部引用**（呼叫獨立流程，可重用）。

---

## ✅ **BPMN End Event** 幾種類型的例子**

---

### 0. **Plain End Event（普通結束事件）**

🔚 **例子**
：

### 1. **Message End Event（訊息結束事件）**

📩 **例子**：
銀行處理完客戶的信用證申請後，系統自動發送一封「申請完成通知」給客戶。
👉 流程結束時，伴隨著一個 **訊息發送**。

---

### 2. **Escalation End Event（升級結束事件）**

⚠️ **例子**：
審批過程中，如果金額超過 1,000 萬美元，則自動 **升級**，將案件提交到更高層級主管處理。
👉 流程結束，但會觸發一個 **升級事件**給上級流程。

---

### 3. **Error End Event（錯誤結束事件）**

❌ **例子**：
付款交易中，如果發現資金不足，流程以 **錯誤事件**結束，並返回「資金不足」錯誤給核心系統。
👉 流程異常結束，通常會進入 **錯誤處理邏輯**。

---

### 4. **Compensation End Event（補償結束事件）**

↩️ **例子**：
在旅遊預訂系統中，如果付款成功但機票訂位失敗，流程以補償事件結束，觸發 **退款動作**。
👉 流程結束並要求 **補償動作（撤銷、退款、回滾）**。

---

### 5. **Signal End Event（信號結束事件）**

📡 **例子**：
在供應鏈流程中，倉庫庫存不足時，流程以 **信號事件**結束，廣播「庫存不足」給所有相關流程（採購、物流、客服）。
👉 發出全局信號，讓其他流程能同步響應。

---

### 6. **Terminate End Event（終止結束事件）**

⏹️ **例子**：
在貸款申請流程中，如果客戶被判定為高風險，流程直接 **終止**，所有正在進行的子流程（如 KYC、徵信查詢）都被強制停止。
👉 **強制終止**整個流程，立即結束。

---

✅ **總結**：

* **Message** → 發送通知
* **Escalation** → 向上升級
* **Error** → 錯誤結束
* **Compensation** → 觸發補償動作
* **Signal** → 廣播事件
* **Terminate** → 強制終止全部流程

---
